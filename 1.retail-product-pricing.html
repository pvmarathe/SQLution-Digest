<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Problem Solving Newsletter</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>SQL Problem Solving Newsletter</h1>
        <nav>
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#archive">Archive</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <article>
            <h2>Problem #1: Nth Highest Product Price</h2>
            <section class="problem-statement">
                <h3>Problem Statement</h3>
                <p>A retail store wants to analyze its product pricing. Write a SQL query to get the nth highest price from the Products table.</p>
                <h4>Table: Products</h4>
                <table>
                    <tr><th>Id</th><th>ProductName</th><th>Price</th></tr>
                    <tr><td>1</td><td>T-shirt</td><td>19.99</td></tr>
                    <tr><td>2</td><td>Jeans</td><td>49.99</td></tr>
                    <tr><td>3</td><td>Sneakers</td><td>79.99</td></tr>
                </table>
                <p>Write a SQL function <code>getNthHighestPrice(N)</code> that returns the Nth highest price. Your function should return null if there aren't at least N distinct prices in the Products table.</p>
            </section>

            <section class="solution">
                <h3>Solution</h3>
                <pre><code>
CREATE FUNCTION getNthHighestPrice(N INT) RETURNS DECIMAL(10,2)
BEGIN
  RETURN (
    SELECT DISTINCT Price
    FROM (
      SELECT Price, 
             DENSE_RANK() OVER (ORDER BY Price DESC) as price_rank
      FROM Products
    ) ranked_prices
    WHERE price_rank = N
  );
END
                </code></pre>
            </section>

            <section class="explanation">
                <h3>Explanation</h3>
                <p>This SQL function does the following:</p>
                <ol>
                    <li>Ranks all prices from highest to lowest using DENSE_RANK().</li>
                    <li>Finds the price that has the rank we're looking for (Nth highest).</li>
                    <li>Returns that price, or NULL if it doesn't exist.</li>
                </ol>
                <p>This solution handles cases where there might be duplicate prices and correctly returns NULL if there is no Nth highest price.</p>
            </section>
        </article>
    </main>

    <footer>
        <p>&copy; 2024 SQL Problem Solving Newsletter. All rights reserved.</p>
    </footer>
</body>
</html>